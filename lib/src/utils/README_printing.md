# نظام الطباعة المحسن - Enhanced Printing System

## نظرة عامة
تم تطوير نظام طباعة متقدم يدعم جميع أنواع الطابعات والأوراق مع تصميم احترافي للفواتير مثل فواتير الكاشير في المحلات التجارية الحقيقية.

## المميزات الجديدة

### 1. دعم أنواع مختلفة من الطابعات والأوراق
- **طابعة حرارية 58mm**: مناسبة للفواتير الصغيرة
- **طابعة حرارية 80mm**: مناسبة للفواتير العادية (افتراضي)
- **ورقة A4**: مناسبة للفواتير التفصيلية
- **ورقة A5**: مناسبة للفواتير المتوسطة
- **ورقة Letter**: مناسبة للفواتير الأمريكية
- **فاتورة صغيرة**: مناسبة للفواتير السريعة
- **فاتورة عادية**: مناسبة للفواتير الرسمية

### 2. تصميم احترافي للفواتير
- **رأس الفاتورة**: يحتوي على اسم المحل، العنوان، الهاتف، رقم الفاتورة والتاريخ
- **معلومات الدفع**: عرض نوع الدفع مع ألوان مميزة (نقداً = أخضر، آجل = برتقالي، تقسيط = أزرق)
- **معلومات العميل**: عرض تفاصيل العميل إذا كانت متوفرة
- **جدول المنتجات**: جدول منظم يعرض اسم المنتج، الكمية، السعر، والمجموع
- **قسم المجموع**: عرض المجموع الكلي بشكل بارز
- **تذييل الفاتورة**: رسالة شكر ومعلومات إضافية

### 3. خيارات طباعة متقدمة
- **اختيار نوع الورق**: قائمة منسدلة لاختيار نوع الورق المناسب
- **عرض الشعار**: إمكانية إضافة شعار المحل للفاتورة
- **عرض الباركود**: إمكانية إضافة باركود للفاتورة
- **حفظ الإعدادات**: حفظ إعدادات الطباعة للاستخدام المستقبلي

### 4. طباعة سريعة
- **زر طباعة سريعة**: طباعة فورية بالإعدادات المحفوظة
- **زر طباعة متقدم**: طباعة مع خيارات قابلة للتخصيص

## الملفات المحدثة

### 1. `lib/src/utils/invoice_pdf.dart`
- إعادة كتابة كاملة لنظام إنشاء PDF
- دعم أنواع مختلفة من الأوراق
- تصميم احترافي للفواتير
- تنسيق تلقائي للخطوط حسب نوع الورق

### 2. `lib/src/services/print_service.dart`
- خدمة طباعة متقدمة جديدة
- إدارة إعدادات الطباعة
- واجهة مستخدم لخيارات الطباعة
- طباعة سريعة ومتقدمة

### 3. `lib/src/screens/sales_screen.dart`
- تحديث دالة الطباعة لاستخدام النظام الجديد
- إضافة زر طباعة سريعة
- تحسين تجربة المستخدم

## كيفية الاستخدام

### الطباعة العادية
1. بعد إتمام البيع، اضغط على "طباعة الفاتورة"
2. اختر نوع الورق من القائمة المنسدلة
3. حدد الخيارات الإضافية (الشعار، الباركود)
4. اضغط "طباعة"

### الطباعة السريعة
1. بعد إتمام البيع، اضغط على "طباعة سريعة"
2. سيتم الطباعة مباشرة بالإعدادات المحفوظة

### حفظ الإعدادات
- يتم حفظ إعدادات الطباعة تلقائياً عند استخدام خيارات الطباعة المتقدمة
- يمكن تغيير الإعدادات في أي وقت

## التنسيق التلقائي

### أحجام الخطوط
- **طابعة 58mm**: خط أصغر (80% من الحجم العادي)
- **طابعة 80mm**: خط عادي (100%)
- **أوراق عادية**: خط أكبر (120% من الحجم العادي)

### تخطيط الصفحة
- **هوامش**: 8px من جميع الجهات
- **مسافات**: مسافات مناسبة بين العناصر
- **ألوان**: ألوان مميزة لنوع الدفع

## دعم أنواع الدفع

### نقداً (Cash)
- لون أخضر
- لا يوجد تاريخ استحقاق

### آجل (Credit)
- لون برتقالي
- عرض تاريخ الاستحقاق

### تقسيط (Installment)
- لون أزرق
- عرض تاريخ الاستحقاق

## معلومات إضافية

### رقم الفاتورة
- تنسيق: `INV-YYYYMMDD-XXXXXXX`
- فريد لكل فاتورة
- يعرض في الرأس والتذييل

### معلومات العميل
- الاسم
- الهاتف
- العنوان
- تظهر فقط إذا كانت متوفرة

## استكشاف الأخطاء

### مشاكل الطباعة
- تأكد من توصيل الطابعة
- تحقق من نوع الورق المحدد
- تأكد من وجود مساحة كافية في الطابعة

### مشاكل التنسيق
- جرب نوع ورق مختلف
- تحقق من إعدادات الطابعة
- تأكد من دعم الطابعة للحجم المحدد

## التطوير المستقبلي

### ميزات مخططة
- دعم الشعارات المخصصة
- دعم الباركود الفعلي
- قوالب فواتير قابلة للتخصيص
- دعم اللغات المتعددة
- تصدير إلى Excel/CSV

### تحسينات مقترحة
- معاينة الفاتورة قبل الطباعة
- إعدادات طابعة متقدمة
- دعم الطابعات الشبكية
- نسخ احتياطي للإعدادات
