# ุฅุตูุงุญ ุดุงูู ููุดููุฉ ุฒุฑ ุฅุชูุงู ุงูุจูุน

## ๐ ุชุญููู ุงููุดููุฉ

### ุงููุดููุฉ ุงูุฃุณุงุณูุฉ:
ุฒุฑ "ุฅุชูุงู ุงูุจูุน" ูุนูู ุนูู ุฌูุงุฒ ูุงุญุฏ ููุง ูุนูู ุนูู ุฃุฌูุฒุฉ ุฃุฎุฑู.

### ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:
1. **ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**: ุงุฎุชูุงูุงุช ูู ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **ูุดุงูู ุงูุตูุงุญูุงุช**: ุนุฏู ูุฌูุฏ ุตูุงุญูุงุช ุงููุชุงุจุฉ
3. **ูุดุงูู ุงูุฅุตุฏุงุฑุงุช**: ุงุฎุชูุงูุงุช ูู ุฅุตุฏุงุฑุงุช Flutter/SQLite
4. **ูุดุงูู ุงูุฐุงูุฑุฉ**: ููุงุฏ ุงูุฐุงูุฑุฉ ุฃุซูุงุก ุงููุนุงููุฉ
5. **ูุดุงูู ุงูุดุจูุฉ**: ุฅุฐุง ูุงู ุงูุชุทุจูู ูุณุชุฎุฏู API ุฎุงุฑุฌู

## ๐๏ธ ุงูุญููู ุงููุทุจูุฉ

### ุงูุญู ุงูุฃูู: ุชุญุณูู ุฏุงูุฉ createSale

```dart
// ุฅุถุงูุฉ ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุญุณูุฉ
Future<int> createSale({
  int? customerId,
  String? customerName,
  String? customerPhone,
  String? customerAddress,
  DateTime? dueDate,
  required String type,
  required List<Map<String, Object?>> items,
  bool decrementStock = true,
  int? installmentCount,
  double? downPayment,
  DateTime? firstInstallmentDate,
}) async {
  try {
    // ูุญุต ุตุญุฉ ุงูุจูุงูุงุช ูุจู ุงูุจุฏุก
    if (items.isEmpty) {
      throw Exception('ูุง ูููู ุฅูุดุงุก ุจูุน ุจุฏูู ููุชุฌุงุช');
    }

    // ูุญุต ุตุญุฉ ูู ููุชุฌ
    for (final item in items) {
      if (item['product_id'] == null) {
        throw Exception('ูุนุฑู ุงูููุชุฌ ูุทููุจ');
      }
      if (item['quantity'] == null || (item['quantity'] as num) <= 0) {
        throw Exception('ุงููููุฉ ูุฌุจ ุฃู ุชููู ุฃูุจุฑ ูู ุตูุฑ');
      }
    }

    return await _db.transaction<int>((txn) async {
      // ุจุงูู ุงูููุฏ...
    });
  } catch (e) {
    debugPrint('ุฎุทุฃ ูู ุฅูุดุงุก ุงูุจูุน: $e');
    rethrow;
  }
}
```

### ุงูุญู ุงูุซุงูู: ุฅุถุงูุฉ ูุญุต ุงูุตูุงุญูุงุช

```dart
// ูุญุต ุงูุตูุงุญูุงุช ูุจู ุฅูุดุงุก ุงูุจูุน
if (!PermissionUtils.checkPermission(
  context,
  UserPermission.manageSales,
  showMessage: true,
)) {
  return;
}
```

### ุงูุญู ุงูุซุงูุซ: ุฅุถุงูุฉ ุฑุณุงุฆู ุชุดุฎูุต

```dart
// ุฅุถุงูุฉ ุฑุณุงุฆู ุชุดุฎูุต ููุตูุฉ
debugPrint('ุจุฏุก ุฅูุดุงุก ุงูุจูุน...');
debugPrint('ููุน ุงูุจูุน: $type');
debugPrint('ุนุฏุฏ ุงูููุชุฌุงุช: ${items.length}');
debugPrint('ุงุณู ุงูุนููู: $customerName');

try {
  final saleId = await db.createSale(/* ุงููุนุงููุงุช */);
  debugPrint('ุชู ุฅูุดุงุก ุงูุจูุน ุจูุฌุงุญ: $saleId');
  return saleId;
} catch (e) {
  debugPrint('ูุดู ูู ุฅูุดุงุก ุงูุจูุน: $e');
  debugPrint('ููุน ุงูุฎุทุฃ: ${e.runtimeType}');
  rethrow;
}
```

## ๐ง ุงูุญููู ุงูุนูููุฉ

### ุงูุญู ุงูุฃูู: ุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฅุนุงุฏุฉ ุฅูุดุงุฆูุง

```bash
# ุนูู Windows
del "%USERPROFILE%\Documents\pos_office.db"

# ุนูู Linux/Mac
rm ~/Documents/pos_office.db

# ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู
flutter run -d windows
```

### ุงูุญู ุงูุซุงูู: ุชุดุบูู ุงูุชุทุจูู ููุฏูุฑ

1. ุงููุฑ ุจุฒุฑ ุงููุงูุณ ุงูุฃููู ุนูู ููู `.exe`
2. ุงุฎุชุฑ "ุชุดุบูู ููุฏูุฑ"
3. ุฌุฑุจ ุฒุฑ "ุฅุชูุงู ุงูุจูุน"

### ุงูุญู ุงูุซุงูุซ: ูุญุต ุงูุตูุงุญูุงุช

```bash
# ุชุฃูุฏ ูู ุฃู ุงููุฌูุฏ ูุงุจู ูููุชุงุจุฉ
# ุนูู Windows
icacls "%USERPROFILE%\Documents" /grant Everyone:F

# ุนูู Linux/Mac
chmod 755 ~/Documents
```

### ุงูุญู ุงูุฑุงุจุน: ูุณุฎ ุงูุชุทุจูู ุงููุจูู

```bash
# ุงูุณุฎ ูุฌูุฏ ุงูุชุทุจูู ูู ุงูุฌูุงุฒ ุงูุฐู ูุนูู
# ุฅูู ุงูุฌูุงุฒ ุงูุฐู ูุง ูุนูู
cp -r build/windows/x64/runner/Release/ /path/to/other/device/
```

## ๐ ุฑุณุงุฆู ุงูุฎุทุฃ ุงููุญุชููุฉ

### 1. ุฎุทุฃ ูุงุนุฏุฉ ุงูุจูุงูุงุช
```
SqliteException: database is locked
```
**ุงูุญู**: ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู

### 2. ุฎุทุฃ ุงูุตูุงุญูุงุช
```
Permission denied
```
**ุงูุญู**: ุชุดุบูู ููุฏูุฑ ุฃู ูุญุต ุตูุงุญูุงุช ุงููุฌูุฏ

### 3. ุฎุทุฃ ุงูุฐุงูุฑุฉ
```
OutOfMemoryError
```
**ุงูุญู**: ุฅุบูุงู ุงูุชุทุจููุงุช ุงูุฃุฎุฑู ุฃู ุฒูุงุฏุฉ ุงูุฐุงูุฑุฉ

### 4. ุฎุทุฃ ุงูุจูุงูุงุช
```
UNIQUE constraint failed
```
**ุงูุญู**: ุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฅุนุงุฏุฉ ุฅูุดุงุฆูุง

## ๐งช ุงุฎุชุจุงุฑ ุงูุญููู

### ุงุฎุชุจุงุฑ 1: ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช
```dart
// ุฃุถู ูุฐุง ุงูููุฏ ูู main.dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช
  try {
    final db = DatabaseService();
    await db.initialize();
    print('โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุนูู ุจุดูู ุตุญูุญ');
  } catch (e) {
    print('โ ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: $e');
  }
  
  runApp(MyApp());
}
```

### ุงุฎุชุจุงุฑ 2: ูุญุต ุงูุตูุงุญูุงุช
```dart
// ุฃุถู ูุฐุง ูู ุดุงุดุฉ ุงููุจูุนุงุช
void _testPermissions() async {
  try {
    // ูุญุต ุตูุงุญูุงุช ุงููุชุงุจุฉ
    final file = File('${Directory.systemTemp.path}/test_write.txt');
    await file.writeAsString('test');
    await file.delete();
    print('โ ุงูุตูุงุญูุงุช ุชุนูู ุจุดูู ุตุญูุญ');
  } catch (e) {
    print('โ ูุดููุฉ ูู ุงูุตูุงุญูุงุช: $e');
  }
}
```

### ุงุฎุชุจุงุฑ 3: ูุญุต ุงูุฐุงูุฑุฉ
```dart
// ุฃุถู ูุฐุง ูู ุฏุงูุฉ createSale
void _checkMemory() {
  final info = ProcessInfo.currentRss;
  print('ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ: ${info ~/ 1024 ~/ 1024} MB');
  
  if (info > 500 * 1024 * 1024) { // 500 MB
    print('โ๏ธ ุชุญุฐูุฑ: ุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุนุงูู');
  }
}
```

## ๐ ูุงุฆูุฉ ุงูุชุญูู

### ูุจู ุงูุชุทุจูู:
- [ ] ูุณุฎ ุงุญุชูุงุทู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุฅุบูุงู ุฌููุน ุงูุชุทุจููุงุช ุงูุฃุฎุฑู
- [ ] ูุญุต ูุณุงุญุฉ ุงููุฑุต ุงููุชุงุญุฉ

### ุฃุซูุงุก ุงูุชุทุจูู:
- [ ] ูุฑุงูุจุฉ ุฑุณุงุฆู ุงูุชุดุฎูุต
- [ ] ูุญุต ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ
- [ ] ุชุณุฌูู ุฃู ุฃุฎุทุงุก ุชุธูุฑ

### ุจุนุฏ ุงูุชุทุจูู:
- [ ] ุงุฎุชุจุงุฑ ุฌููุน ุฃููุงุน ุงูุจูุน (ููุฏูุ ุขุฌูุ ุฃูุณุงุท)
- [ ] ูุญุต ุตุญุฉ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุงุฎุชุจุงุฑ ุนูู ุฃุฌูุฒุฉ ูุฎุชููุฉ

## ๐ ุงูุญู ุงูููุงุฆู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ุฌุฑุจ ูุฐุง ุงูุญู ุงูุดุงูู:

```dart
// ูู ุดุงุดุฉ ุงููุจูุนุงุชุ ุฃุถู ูุฐุง ุงูููุฏ
Future<void> _completeSaleWithRetry() async {
  int retryCount = 0;
  const maxRetries = 3;
  
  while (retryCount < maxRetries) {
    try {
      // ูุญุงููุฉ ุฅูุดุงุก ุงูุจูุน
      final saleId = await db.createSale(/* ุงููุนุงููุงุช */);
      
      // ูุฌุญ - ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ
      if (mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text('ุชู ุฅูุดุงุก ุงูุจูุน ุจูุฌุงุญ #$saleId'),
            backgroundColor: Colors.green,
          ),
        );
      }
      return;
      
    } catch (e) {
      retryCount++;
      debugPrint('ูุญุงููุฉ $retryCount ูุดูุช: $e');
      
      if (retryCount >= maxRetries) {
        // ูุดูุช ุฌููุน ุงููุญุงููุงุช
        if (mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('ูุดู ูู ุฅูุดุงุก ุงูุจูุน: $e'),
              backgroundColor: Colors.red,
              duration: Duration(seconds: 5),
            ),
          );
        }
        return;
      }
      
      // ุงูุชุธุงุฑ ูุจู ุงููุญุงููุฉ ุงูุชุงููุฉ
      await Future.delayed(Duration(seconds: 1));
    }
  }
}
```

## ๐ ุงูุฏุนู ุงูููู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ูุฏู ูุฐู ุงููุนูููุงุช:

1. **ูุธุงู ุงูุชุดุบูู**: Windows/Linux/Mac
2. **ุฅุตุฏุงุฑ Flutter**: `flutter --version`
3. **ุฑุณุงุฆู ุงูุฎุทุฃ**: ูู ูุญุฏุฉ ุงูุชุญูู
4. **ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ**: ุนูุฏ ุญุฏูุซ ุงูุฎุทุฃ
5. **ุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช**: `ls -la pos_office.db`

---

**ููุงุญุธุฉ**: ูุฐุง ุงูุญู ุดุงูู ููุฌุจ ุฃู ูุญู ุงููุดููุฉ ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ. ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุฅุนุฏุงุฏุงุช ุงููุธุงู ุฃู ุงูุฃูุงู.
