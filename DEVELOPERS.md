## دليل المطورين (Arabic Developers Guide)

### نظرة عامة
هذا المشروع هو نظام إدارة مكتب مبني باستخدام Flutter/Dart مع قاعدة بيانات محلية (SQLite عبر `sqflite` ونسخته `sqflite_common_ffi` لسطح المكتب). يدعم التطبيق أنظمة التشغيل: Windows, Linux, macOS, Android و iOS، ويستخدم مزودي الحالة عبر `provider`.

### المتطلبات المسبقة
- Flutter SDK (قناة stable) محدثة
- Dart SDK مضمن مع Flutter
- أداة git
- على ويندوز: Visual Studio Build Tools (مع دعم C++‎) لبناء تطبيقات سطح المكتب
- على macOS: Xcode لبناء iOS/macOS
- على Linux: أدوات بناء GTK حسب التوزيعة

### بدء العمل بسرعة
1. استنساخ المستودع:
   - `git clone <repo-url>` ثم `cd office_mangment_system`
2. جلب الحزم:
   - `flutter pub get`
3. تفعيل منصات سطح المكتب (إذا لزم):
   - `flutter config --enable-windows-desktop`
   - `flutter config --enable-macos-desktop`
   - `flutter config --enable-linux-desktop`
4. التشغيل:
   - موبايل: `flutter run -d windows|android|ios` حسب الهدف
   - ويب (اختياري): `flutter run -d chrome`

### بنية المشروع
- `lib/main.dart`: نقطة الدخول وتهيئة القاعدة والـ Providers وتهيئة اللغة العربية.
- `lib/src/app_shell.dart`: الحاوية الأساسية للتنقل والهيكل العام للواجهات.
- `lib/src/services/db/database_service.dart`: منطق قاعدة البيانات، الإنشاء، الترحيلات، الاستعلامات.
- `lib/src/services/*`: مزودو الحالة `ChangeNotifier` والخدمات المختلفة.
- `lib/src/screens/*`: الشاشات الرئيسية والفرعية.
- `lib/src/widgets/*`: الودجات القابلة لإعادة الاستخدام مثل `EmptyState`.
- `assets/`: الخطوط والصور والموارد.
- `test/`: اختبارات وحدة وتكامل وأداء.

### الأنماط المعمارية
- إدارة الحالة عبر `provider` + `ChangeNotifier`.
- فصل واضح بين طبقة العرض (Screens/Widgets) وطبقة البيانات (Services/DB) وطبقة الحالة (ViewModels).
- جميع الاستعلامات على SQLite تمر عبر `DatabaseService` فقط.

### إرشادات أسلوب الكود
- تسمية واضحة معبرة بالإنجليزية للكود، والتعليقات التوضيحية باللغة العربية.
- تجنب الاختصارات غير الواضحة.
- دوال قصيرة تركز على مهمة واحدة مع معالجة أخطاء مبكرة.
- استخدام `///` للتوثيق أعلى الصفوف والدوال العامة، و`//` للتعليقات المختصرة داخل الكود.
- عدم إسكات التحذيرات إلا لسبب واضح.

### قاعدة البيانات
- على سطح المكتب نستخدم `sqflite_common_ffi` ويتم تهيئته تلقائيًا في `main.dart`.
- تأكد من إضافة أي جداول/أعمدة جديدة عبر مسارات ترحيل واضحة داخل `DatabaseService`.
- وفر دوال استعلام/تحديث عالية المستوى في `DatabaseService` بدل نثر الاستعلامات في الشاشات.

### الاختبارات
- شغّل جميع الاختبارات:
  - `flutter test -r expanded`
- مواقع الاختبارات:
  - `test/unit/*`: اختبارات الوحدات لمزودي الحالة والدوال.
  - `test/integration/*`: سيناريوهات تدفق فعلية.
  - `test/performance/*`: قياسات زمنية أساسية.

### إضافة ميزة جديدة (مختصر خطوات مقترحة)
1. حدّد نموذج البيانات والتغييرات على القاعدة (إن وجدت) وأضف ترحيلًا.
2. أضف/حدث الدوال في `DatabaseService`.
3. أنشئ ViewModel جديدًا أو حدث القائم مع حالات وتحميل بيانات.
4. أنشئ شاشة/ودجات وتوصيلها بالـ ViewModel عبر `ChangeNotifierProvider`.
5. أضف اختبارات (وحدة وتكامل) تغطي المسارات الأساسية وحالات الخطأ.

### إرشادات المساهمة
- أنشئ فرعًا لكل ميزة: `feat/<اسم-قصير>` أو إصلاح: `fix/<اسم-قصير>`.
- حافظ على صغر حجم المراجعات مع وصف عربي واضح للتغييرات.
- تأكد من نجاح البناء والاختبارات قبل فتح Pull Request.

### استكشاف الأخطاء الشائعة
- "database is locked": أغلق النسخ الأخرى من التطبيق، أعد التشغيل. الكود يعالج ذلك برسالة عربية.
- مشاكل محارف/اتجاه النص: تأكد من `Directionality.rtl` في `main.dart` وأن الخطوط مضمنة.
- فشل على سطح المكتب: تحقق من تهيئة `sqflite_common_ffi` ومن أدوات البناء للنظام.

### تواصل
لأي استفسارات تقنية، يرجى فتح تذكرة وإرفاق وصف مختصر بالعربية وخطوات إعادة المشكلة ولقطات شاشة إن أمكن.


