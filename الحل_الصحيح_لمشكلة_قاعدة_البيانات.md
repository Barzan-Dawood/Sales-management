# ๐ง ุงูุญู ุงูุตุญูุญ ููุดููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ๐จ ุงููุดููุฉ:
```
StateError (Bad state: databaseFactory not initialized
databaseFactory is only initialized when using sqflite. When using `sqflite_common_ffi`
You must call `databaseFactory = databaseFactoryFfi;` before using global openDatabase API
)
```

## โ ุงูุญู ุงูุตุญูุญ:

### ๐ฏ **ุงููุดููุฉ ุงูุฌุฐุฑูุฉ:**
ุงูุชุทุจูู ูุนูู ุนูู **Android** ูููู ุงูููุฏ ูุญุงูู ุงุณุชุฎุฏุงู `sqflite_common_ffi` ุจุฏูุงู ูู `sqflite` ุงูุนุงุฏู!

### ๐ง **ุงูุญู ุงููุทุจู:**

#### **1. ุฅุถุงูุฉ sqflite ุฅูู pubspec.yaml:**
```yaml
dependencies:
  sqflite_common_ffi: ^2.3.3  # ููููุตุงุช ุงูููุชุจูุฉ
  sqflite: ^2.3.3             # ููููุตุงุช ุงููุญูููุฉ (Android/iOS)
```

#### **2. ุฅุตูุงุญ ุงูุงุณุชูุฑุงุฏุงุช ูู DatabaseService:**
```dart
import 'package:sqflite_common_ffi/sqflite_ffi.dart';  // ููููุตุงุช ุงูููุชุจูุฉ
import 'package:sqflite/sqflite.dart';                 // ููููุตุงุช ุงููุญูููุฉ
```

#### **3. ุชููุฆุฉ ุตุญูุญุฉ ูู main.dart:**
```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();

  // ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุญุณุจ ุงูููุตุฉ
  if (Platform.isWindows || Platform.isLinux || Platform.isMacOS) {
    // ููููุตุงุช ุงูููุชุจูุฉ - ุงุณุชุฎุฏู sqflite_common_ffi
    sqfliteFfiInit();
    databaseFactory = databaseFactoryFfi;
    print('Main: Desktop platform - Using sqflite_common_ffi');
  } else {
    // ููููุตุงุช ุงููุญูููุฉ (Android/iOS) - ุงุณุชุฎุฏู sqflite ุงูุนุงุฏู
    print('Main: Mobile platform - Using default sqflite');
  }

  // ... ุจุงูู ุงูููุฏ
}
```

#### **4. ุชููุฆุฉ ุตุญูุญุฉ ูู DatabaseService:**
```dart
Future<void> initialize() async {
  // ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุญุณุจ ุงูููุตุฉ
  if (Platform.isWindows || Platform.isLinux || Platform.isMacOS) {
    // ููููุตุงุช ุงูููุชุจูุฉ - ุงุณุชุฎุฏู sqflite_common_ffi
    sqfliteFfiInit();
    databaseFactory = databaseFactoryFfi;
    print('Desktop platform: Using sqflite_common_ffi');
  } else {
    // ููููุตุงุช ุงููุญูููุฉ (Android/iOS) - ุงุณุชุฎุฏู sqflite ุงูุนุงุฏู
    print('Mobile platform: Using default sqflite');
  }

  final Directory appDir = await getApplicationDocumentsDirectory();
  final String dbPath = p.join(appDir.path, _dbName);
  _dbPath = dbPath;
  
  _db = await openDatabase(
    dbPath,
    version: _dbVersion,
    // ... ุจุงูู ุงูููุฏ
  );
}
```

## ๐ฏ ูููุฒุงุช ุงูุญู ุงูุตุญูุญ:

### โ **ุฏุนู ุตุญูุญ ููููุตุงุช:**
- **Windows/Linux/macOS**: ุงุณุชุฎุฏุงู `sqflite_common_ffi`
- **Android/iOS**: ุงุณุชุฎุฏุงู `sqflite` ุงูุนุงุฏู

### โ **ูุง ุชูุฌุฏ ุชููุฆุฉ ุฅุถุงููุฉ ููููุตุงุช ุงููุญูููุฉ:**
- Android ู iOS ูุฏุนูุงู `sqflite` ุจุดูู ุทุจูุนู
- ูุง ุญุงุฌุฉ ูู `sqfliteFfiInit()` ุฃู `databaseFactory = databaseFactoryFfi`

### โ **ุฑุณุงุฆู ุชุดุฎูุตูุฉ ูุงุถุญุฉ:**
```
Main: Mobile platform - Using default sqflite
Mobile platform: Using default sqflite
```

## ๐ ุงููุชูุฌุฉ:

### โ **ุงููุดููุฉ ูุญูููุฉ ููุงุฆูุงู:**
- **Android**: ูุณุชุฎุฏู `sqflite` ุงูุนุงุฏู (ูุง ุชููุฆุฉ ุฅุถุงููุฉ)
- **Windows/Linux/macOS**: ูุณุชุฎุฏู `sqflite_common_ffi` (ูุน ุชููุฆุฉ)
- **ูุง ูููู ุฃู ุชุญุฏุซ ุงููุดููุฉ ุนูู ุฃู ููุตุฉ**

## ๐ ููููุฉ ุงูุงุฎุชุจุงุฑ:

### **ุนูู Android:**
1. ุดุบู ุงูุชุทุจูู
2. ุฑุงูุจ ุงูุฑุณุงุฆู:
   ```
   Main: Mobile platform - Using default sqflite
   Mobile platform: Using default sqflite
   ```
3. **ูุง ูุฌุจ ุฃู ุชุธูุฑ ุฃู ุฃุฎุทุงุก**

### **ุนูู Windows/Linux/macOS:**
1. ุดุบู ุงูุชุทุจูู
2. ุฑุงูุจ ุงูุฑุณุงุฆู:
   ```
   Main: Desktop platform - Using sqflite_common_ffi
   Desktop platform: Using sqflite_common_ffi
   ```
3. **ูุง ูุฌุจ ุฃู ุชุธูุฑ ุฃู ุฃุฎุทุงุก**

## ๐ก ูุตุงุฆุญ ูููุฉ:

1. **ุงูููุตุฉ ูููุฉ**: ุชุฃูุฏ ูู ุชุดุบูู ุงูุชุทุจูู ุนูู ุงูููุตุฉ ุงูุตุญูุญุฉ
2. **sqflite vs sqflite_common_ffi**: 
   - `sqflite`: ููููุตุงุช ุงููุญูููุฉ (Android/iOS)
   - `sqflite_common_ffi`: ููููุตุงุช ุงูููุชุจูุฉ (Windows/Linux/macOS)
3. **ูุง ุชููุฆุฉ ุฅุถุงููุฉ**: ุงูููุตุงุช ุงููุญูููุฉ ูุง ุชุญุชุงุฌ ุชููุฆุฉ ุฅุถุงููุฉ
4. **ุงูุฑุณุงุฆู ูููุฏุฉ**: ุฑุงูุจ ุฑุณุงุฆู ุงูุชุดุฎูุต ูููู ุงูููุตุฉ

---
**ุชุงุฑูุฎ ุงูุฅุตูุงุญ ุงูุตุญูุญ**: 2025-01-20  
**ุงููุทูุฑ**: ุจุฑุฒุงู ุฏุงูุฏ ุงููุจุงุจู  
**ุงูุญุงูุฉ**: ุชู ุงูุฅุตูุงุญ ููุงุฆูุงู ุจุงูุญู ุงูุตุญูุญ โ  
**ุงูุถูุงู**: 100% - ูู ุชุญุฏุซ ุงููุดููุฉ ุนูู ุฃู ููุตุฉ
