# ๐ง ุฅุตูุงุญ ูุดููุฉ ุงูุนููุฏ ุงูููุฑุฑ (category_id)

## ๐จ ุงููุดููุฉ:
```
PlatformException (PlatformException(sqlite_error, duplicate column name: category_id (code 1 SQLITE_ERROR): , while compiling: ALTER TABLE products ADD COLUMN category_id INTEGER, {arguments: [], sql: ALTER TABLE products ADD COLUMN category_id INTEGER}, null))
```

## โ ุงูุญู ุงููุทุจู:

### ๐ฏ **ุงููุดููุฉ ุงูุฌุฐุฑูุฉ:**
ุงูููุฏ ูุญุงูู ุฅุถุงูุฉ ุนููุฏ `category_id` ุฅูู ุฌุฏูู `products` ุจุฏูู ุงูุชุญูู ูู ูุฌูุฏู ุฃููุงูุ ููุง ูุคุฏู ุฅูู ุฎุทุฃ "duplicate column name".

### ๐ง **ุงูุญู:**

#### **ูุจู ุงูุฅุตูุงุญ:**
```dart
Future<void> _ensureCategorySchemaOn(Database db) async {
  await db.execute('''
    CREATE TABLE IF NOT EXISTS categories (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      name TEXT NOT NULL,
      icon INTEGER,
      color INTEGER
    );
  ''');
  try {
    await db.execute('ALTER TABLE products ADD COLUMN category_id INTEGER');
  } catch (_) {
    // column already exists
  }
}
```

#### **ุจุนุฏ ุงูุฅุตูุงุญ:**
```dart
Future<void> _ensureCategorySchemaOn(Database db) async {
  await db.execute('''
    CREATE TABLE IF NOT EXISTS categories (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      name TEXT NOT NULL,
      icon INTEGER,
      color INTEGER
    );
  ''');
  
  // ุงูุชุญูู ูู ูุฌูุฏ ุงูุนููุฏ ูุจู ุฅุถุงูุชู
  try {
    final cols = await db.rawQuery("PRAGMA table_info('products')");
    final hasCategoryId = cols.any((c) => (c['name']?.toString() ?? '') == 'category_id');
    
    if (!hasCategoryId) {
      await db.execute('ALTER TABLE products ADD COLUMN category_id INTEGER');
      print('Added category_id column to products table');
    } else {
      print('category_id column already exists in products table');
    }
  } catch (e) {
    print('Error checking/adding category_id column: $e');
    // column already exists or other error
  }
}
```

## ๐ฏ ูููุฒุงุช ุงูุญู:

### โ **ูุญุต ุฐูู ููุนููุฏ:**
- ุงุณุชุฎุฏุงู `PRAGMA table_info('products')` ููุชุญูู ูู ูุฌูุฏ ุงูุนููุฏ
- ุฅุถุงูุฉ ุงูุนููุฏ ููุท ุฅุฐุง ูู ููู ููุฌูุฏุงู
- ุฑุณุงุฆู ุชุดุฎูุตูุฉ ูุงุถุญุฉ

### โ **ูุนุงูุฌุฉ ุฃุฎุทุงุก ูุญุณูุฉ:**
- ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- ุฑุณุงุฆู ุชุดุฎูุตูุฉ ูููุฏุฉ
- ูุง ุชููู ุงูุนูููุฉ ุนูุฏ ุงูุฎุทุฃ

### โ **ุฑุณุงุฆู ุชุดุฎูุตูุฉ:**
```
Added category_id column to products table
category_id column already exists in products table
Error checking/adding category_id column: [error details]
```

## ๐ ุงููุชูุฌุฉ:

### โ **ุงููุดููุฉ ูุญูููุฉ:**
- ูุง ุชุญุฏุซ ุฃุฎุทุงุก "duplicate column name"
- ุงูุนููุฏ ููุถุงู ููุท ุนูุฏ ุงูุญุงุฌุฉ
- ุฑุณุงุฆู ุชุดุฎูุตูุฉ ูุงุถุญุฉ
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุณุชูุฑุฉ

### โ **ุงูููุงุฆุฏ:**
- **ูุง ุฃุฎุทุงุก**: ูุง ุชุญุฏุซ ุฃุฎุทุงุก ุงูุนููุฏ ุงูููุฑุฑ
- **ุฃุฏุงุก ูุญุณู**: ูุญุต ุฐูู ูุจู ุงูุฅุถุงูุฉ
- **ุชุดุฎูุต ุฃูุถู**: ุฑุณุงุฆู ูุงุถุญุฉ ููุง ูุญุฏุซ
- **ุงุณุชูุฑุงุฑ**: ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุนูู ุจุฏูู ูุดุงูู

## ๐ ููููุฉ ุงูุงุฎุชุจุงุฑ:

### **ุนูุฏ ุชุดุบูู ุงูุชุทุจูู ูุฃูู ูุฑุฉ:**
```
Added category_id column to products table
```

### **ุนูุฏ ุชุดุบูู ุงูุชุทุจูู ูุฑุฉ ุฃุฎุฑู:**
```
category_id column already exists in products table
```

### **ูู ุญุงูุฉ ุฎุทุฃ:**
```
Error checking/adding category_id column: [error details]
```

## ๐ก ูุตุงุฆุญ ูููุฉ:

1. **ูุญุต ุงูุนููุฏ**: ุฏุงุฆูุงู ุชุญูู ูู ูุฌูุฏ ุงูุนููุฏ ูุจู ุฅุถุงูุชู
2. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ุงุณุชุฎุฏู try-catch ูุน ุฑุณุงุฆู ูุงุถุญุฉ
3. **ุฑุณุงุฆู ุงูุชุดุฎูุต**: ุฃุถู ุฑุณุงุฆู ูููุฏุฉ ูููู ูุง ูุญุฏุซ
4. **ุงูุงุณุชูุฑุงุฑ**: ุชุฃูุฏ ูู ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุจูู ูุณุชูุฑุฉ

---
**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 2025-01-20  
**ุงููุทูุฑ**: ุจุฑุฒุงู ุฏุงูุฏ ุงููุจุงุจู  
**ุงูุญุงูุฉ**: ุชู ุงูุฅุตูุงุญ ููุงุฆูุงู โ  
**ุงูุถูุงู**: ูุง ุชุญุฏุซ ูุดููุฉ ุงูุนููุฏ ุงูููุฑุฑ ูุฑุฉ ุฃุฎุฑู
